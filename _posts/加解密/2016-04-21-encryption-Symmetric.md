---
layout:     post
title:      "常用加解密那些事之对称加密"
subtitle:   ""
date:       2016-04-21
author:     "mayfly"
header-img: "img/header/post-bg-sea.jpg"
tags:
    - 加解密
    - 对称加密
---


1. [介绍](#介绍)
2. [几种常用算法介绍](#几种常用算法介绍)
	1. [DES算法](#1、DES算法)
	2. [3DES算法](#2、3DES算法)
	3. [AES算法](#3、AES算法)
	3. [AES与3DES的比较](#AES与3DES的比较)
   

 ## 介绍
对称加密算法是应用较早的加密算法，技术成熟。在对称加密算法中，数据发信方将明文（原始数据）和加密密钥一起经过特殊加密算法处理后，使其变成复杂的加密密文发送出去。收信方收到密文后，若想解读原文，则需要使用加密用过的密钥及相同算法的逆算法对密文进行解密，才能使其恢复成可读明文。在对称加密算法中，使用的密钥只有一个，发收信双方都使用这个密钥对数据进行加密和解密，这就要求解密方事先必须知道加密密钥。目前常用的加解密算法有：DES、3DES、AES、Blowfish、IDEA、RC5、RC6。

 ## 几种常用算法介绍
对称加密算法用来对敏感数据等信息进行加密，常用的算法包括：
>DES（Data Encryption Standard）：数据加密标准，速度较快，适用于加密大量数据的场合。
3DES（Triple DES）：是基于DES，对一块数据用三个不同的密钥进行三次加密，强度更高。
AES（Advanced Encryption Standard）：高级加密标准，是下一代的加密算法标准，速度快，安全级别高；

- ### 1、DES算法
数据加密标准DES(Data Encryption Standard)是一种分组加密算法，以64位为分组，基于56位密钥来对数据进行加密。

- #### 算法描述：
DES是一种典型的块密码—一种将固定长度的平文通过一系列复杂的操作变成同样长度的密文的算法。对DES而言，块长度为64位。同时，DES使用密钥来自定义变换过程，因此算法认为只有持有加密所用的密钥的用户才能解密密文。密钥表面上是64位的，然而只有其中的56位被实际用于算法，其余8位可以被用于奇偶校验，并在算法中被丢弃。因此，DES的有效密钥长度为56位，通常称DES的密钥长度为56位。来源：[数据加密标准](https://zh.wikipedia.org/wiki/%E8%B3%87%E6%96%99%E5%8A%A0%E5%AF%86%E6%A8%99%E6%BA%96)

- #### 算法原理
DES算法把64位的明文输入块变为64位的密文输出块，它所使用的密钥也是64位，其算法主要分为两步：
1. 初始置换
其功能是把输入的64位数据块按位重新组合,并把输出分为L0、R0两部分，每部分各长32位，其置换规则为将输入的第58位换到第一位，第50位换到第2位……依此类推,最后一位是原来的第7位。L0、R0则是换位输出后的两部分，L0是输出的左32位，R0是右32位，例：设置换前的输入值为D1D2D3……D64，则经过初始置换后的结果为:L0=D58D50……D8；R0=D57D49……D7。
2. 逆置换
经过16次迭代运算后，得到L16、R16,将此作为输入，进行逆置换，逆置换正好是初始置换的逆运算，由此即得到密文输出。

![DES算法流程图](http://upload-images.jianshu.io/upload_images/1042709-d2c07805aaf86d0a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

以上为DES算法流程图，详细的DES加密过程参考：[des算法](http://baike.baidu.com/view/584868.htm)和[ DES加密解密算法详解](http://yiluohuanghun.blog.51cto.com/3407300/917168)。

- ### 2、3DES算法
3DES（或称为Triple DES）是三重数据加密算法（TDEA，Triple Data Encryption Algorithm）块密码的通称。它相当于是对每个数据块应用三次DES加密算法。由于计算机运算能力的增强，原版DES密码的密钥长度变得容易被暴力破解；3DES即是设计用来提供一种相对简单的方法，即通过增加DES的密钥长度来避免类似的攻击，而不是设计一种全新的块密码算法。来源[三重数据加密算法](https://zh.wikipedia.org/wiki/%E4%B8%89%E9%87%8D%E8%B3%87%E6%96%99%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95)

- #### 算法原理
使用3条56位的密钥对 数据进行三次加密。3DES（即Triple DES）是DES向AES过渡的加密算法(1999年，NIST将3-DES指定为过渡的加密标准)。
其具体实现如下：设Ek()和Dk()代表DES算法的加密和解密过程，K代表DES算法使用的密钥，P代表明文，C代表密文，这样：
3DES加密过程为：`C=Ek3(Dk2(Ek1(P)))`
3DES解密过程为：`P=Dk1(EK2(Dk3(C)))`

- ### 3、AES算法
2000年10月，NIST（美国国家标准和技术协会）宣布通过从15种侯选算法中选出的一项新的密匙加密标准。Rijndael被选中成为将来的AES。 Rijndael是在 1999 年下半年，由研究员 Joan Daemen 和 Vincent Rijmen 创建的。AES 正日益成为加密各种形式的电子数据的实际标准。
美国标准与技术研究院 (NIST) 于 2002 年 5 月 26 日制定了新的高级加密标准 (AES) 规范。

- #### 算法原理
![AES加解密的流程图](http://upload-images.jianshu.io/upload_images/1042709-ce8867bc8c6cacea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
AES 算法基于排列和置换运算。AES加密过程涉及到4种操作：字节替代（SubBytes）、行移位（ShiftRows）、列混淆（MixColumns）和轮密钥加（AddRoundKey）。从上图可以看出：
>1）解密过程的每一步分别对应操作的逆操作
2）加解密所有操作的顺序正好是相反的。正是由于这两点保证了解密能够正确地恢复明文。加解密中每轮的密钥分别由初始 密钥扩展 得到。算法中16字节的明文、密文和轮密钥都以一个4x4的矩阵表示。

AES 是一个迭代的、对称密钥分组的密码，它可以使用128、192 和 256 位密钥，并且用 128 位（16字节）分组加密和解密数据。与公共密钥密码使用密钥对不同，对称密钥密码使用相同的密钥加密和解密数据。通过分组密码返回的加密数据的位数与输入数据相同。迭代加密使用一个循环结构，在该循环中重复置换和替换输入数据。算法详细过程参考：[密码算法详解——AES](http://www.cnblogs.com/luop/p/4334160.html)及[高级加密标准](https://zh.wikipedia.org/wiki/%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86)

- ### AES与3DES的比较

| 算法名称 | 算法类型 |  密钥长度  | 速度   | 解密时间（建设机器每秒尝试  255  个密钥）   | 资源消耗   |
|----|----|----|----|----|----|
|AES|对称block密码|128、192、256位|高|1490000亿年|低|
|3DES|对称feistel密码|112位或168位|低|46亿年|中|


参考文章：
[常用加密算法的Java实现总结(二)](http://www.blogjava.net/amigoxie/archive/2014/07/06/415503.html)
[SSL常见加密算法](http://www.willrey.com/support/ssl_des.html)